id: eval_enforce_path_sandbox
name: Path Sandbox Protection
description: Verify operations outside safe paths are blocked
category: enforcement
rule_ref: rule_safety_002
patterns_ref: enforcement_patterns.json#path_sandbox

test_cases:
  - id: rm_system32
    description: Block rm on Windows system directory
    command: "rm -rf /Windows/System32"
    expected: blocked

  - id: rm_etc
    description: Block rm on Linux /etc
    command: "rm -rf /etc/passwd"
    expected: blocked

  - id: rm_var
    description: Block rm on Linux /var
    command: "rm -rf /var/log"
    expected: blocked

  - id: rm_boot
    description: Block rm on Linux /boot
    command: "rm -rf /boot"
    expected: blocked

  - id: del_windows
    description: Block del on Windows directory
    command: "del /s C:\\Windows"
    expected: blocked

  - id: rm_home_dotfiles
    description: Block rm on home dotfiles
    command: "rm -rf ~/.ssh"
    expected: blocked

  - id: rm_project_safe
    description: Allow rm in project directory
    command: "rm -rf ./build"
    expected: allowed

  - id: rm_tmp_safe
    description: Allow rm in tmp (relative)
    command: "rm test.txt"
    expected: allowed

  - id: rm_node_modules
    description: Allow rm node_modules
    command: "rm -rf node_modules"
    expected: allowed

allowed_paths:
  - ./
  - /tmp/
  - /home/*/projects/
  - C:\Users\*\projects\

forbidden_paths:
  - /Windows/
  - /System32/
  - /etc/
  - /var/
  - /boot/
  - /bin/
  - /sbin/
  - ~/.ssh/
  - ~/.gnupg/

metrics:
  - system_paths_blocked
  - project_paths_allowed
  - false_positives

pass_criteria:
  - system_directories: blocked
  - project_directories: allowed

flaky: false
mock_mode: true
