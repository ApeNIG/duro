{
  "id": "decision_20260219_080336_b2v7x7",
  "type": "decision",
  "version": "1.0",
  "created_at": "2026-02-19T08:03:36.690256Z",
  "updated_at": "2026-02-20T06:59:58.639139+00:00Z",
  "sensitivity": "internal",
  "tags": [
    "security",
    "layer6",
    "intent-guard",
    "architectural"
  ],
  "source": {
    "workflow": "manual",
    "run_id": null,
    "tool_trace_path": null
  },
  "data": {
    "decision": "Layer 6 uses server-side auto-injection for capability tokens rather than requiring model to pass intent_id",
    "rationale": "Model memory is unreliable and can be manipulated by prompt injection. If an attacker can make the model \"forget\" to pass the token, the security model breaks. Server-side injection at call_tool boundary makes intent a true capability system - the model doesn't need to know anything, the server enforces it.",
    "alternatives": [
      "Require model to explicitly pass intent_id (rejected - relies on model memory)",
      "Use session cookies (rejected - not available in MCP)",
      "Disable risky tools entirely after untrusted content (rejected - too restrictive)"
    ],
    "context": null,
    "reversible": true,
    "outcome": {
      "status": "unverified",
      "verified_at": null,
      "evidence": [],
      "confidence": 0.5
    },
    "episodes_used": [],
    "outcome_status": "validated"
  }
}