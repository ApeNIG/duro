{
  "id": "decision_20260219_081240_y6mqy1",
  "type": "decision",
  "version": "1.0",
  "created_at": "2026-02-19T08:12:40.181483Z",
  "updated_at": null,
  "sensitivity": "internal",
  "tags": [
    "security",
    "layer6",
    "intent-guard",
    "architectural",
    "capability-system"
  ],
  "source": {
    "workflow": "manual",
    "run_id": null,
    "tool_trace_path": null
  },
  "data": {
    "decision": "Layer 6 intent tokens are scoped to user turns with user_turn_id tracking, not to individual tool calls",
    "rationale": "Minting intent inside call_tool() creates a permit printer where the model can self-authorize. By tying intent to user turns: (1) intent is minted exactly once per user message via on_user_message(), (2) tool execution paths use ensure_intent_for_current_user_turn() for idempotent checks, (3) model calling tools cannot mint new intent, (4) untrusted output in session blocks all subsequent intent. This is a real capability system.",
    "alternatives": [
      "Mint intent per tool call (rejected - model self-authorizes)",
      "Require model to pass intent_id (rejected - relies on model memory)",
      "Single session-wide intent (rejected - no scoping)"
    ],
    "context": null,
    "reversible": true,
    "outcome": {
      "status": "unverified",
      "verified_at": null,
      "evidence": [],
      "confidence": 0.5
    },
    "episodes_used": []
  }
}